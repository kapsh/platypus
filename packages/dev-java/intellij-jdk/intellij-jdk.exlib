# Copyright 2018 Alexander Kapshuna
# Distributed under the terms of the GNU General Public License v2

export_exlib_phases pkg_setup src_install

SUMMARY="JetBrains Runtime"
HOMEPAGE="https://bintray.com/jetbrains/intellij-jdk"
MY_ARCHIVE="jbsdk8u${PV/./b}_linux_x64.tar.gz"
DOWNLOADS="https://bintray.com/jetbrains/intellij-jdk/download_file?file_path=${MY_ARCHIVE} -> ${MY_ARCHIVE}"

LICENCES="GPL-2"
SLOT="0"
MYOPTIONS=""

DEPENDENCIES="
    build:
    build+run:
"

UPSTREAM_DOCUMENTATION="https://confluence.jetbrains.com/display/JRE/JetBrains+Runtime"

WORK="${WORKBASE}"

intellij-jdk_pkg_setup() {
    exdirectory --allow /opt
}

intellij-jdk_src_install() {
    local dest="/opt/${PN}"
    dodir "${dest}"

    insinto "${dest}"
    doins -r *

    for exe in "${IMAGE}/${dest}"/bin/*; do
        edo chmod a+x "$exe"
    done
}

